<?xml version = '1.0' encoding = 'utf-8'?>
<dataModel version="2.0" xmlns="http://xmlns.oracle.com/oxp/xmlp" xmlns:xdm="http://xmlns.oracle.com/oxp/xmlp" xmlns:xsd="http://wwww.w3.org/2001/XMLSchema" defaultDataSourceRef="demo">
   <description>
      <![CDATA[Data%20source:%20Oracle%20database%20OE%20&%20HR%20sample%20schemas%20(%20requires%20'demo'%20connection%20to%20be%20set%20up).%20Features:%20Master-detail%20data%20structure;%20calculated%20elements%20using%20expression%20editor,%20parameters%20with%20cascading%20LOVs.]]>
   </description>
   <dataProperties>
      <property name="include_parameters" value="true"/>
      <property name="include_null_Element" value="false"/>
      <property name="include_rowsettag" value="false"/>
      <property name="xml_tag_case" value="upper"/>
   </dataProperties>
   <dataSets>
      <dataSet name="Customers" type="complex">
         <sql dataSourceRef="demo">
            <![CDATA[select	 "CUSTOMERS_VIEW"."CUSTOMER_ID" as "CUSTOMER_ID",
	 ("CUSTOMERS_VIEW"."CUST_LAST_NAME"||' '|| "CUSTOMERS_VIEW"."CUST_FIRST_NAME") as "CUSTOMER_NAME",
         "CUSTOMERS_VIEW"."STREET_ADDRESS" as "STREET_ADDRESS",
	 "CUSTOMERS_VIEW"."POSTAL_CODE" as "POSTAL_CODE",
	 "CUSTOMERS_VIEW"."CITY" as "CITY",
	 "CUSTOMERS_VIEW"."STATE_PROVINCE" as "STATE_PROVINCE",
	 "CUSTOMERS_VIEW"."COUNTRY_NAME" as "COUNTRY_NAME",
	 "CUSTOMERS_VIEW"."CUST_EMAIL" as "CUST_EMAIL",
	 "CUSTOMERS_VIEW"."PRIMARY_PHONE_NUMBER" as "PRIMARY_PHONE_NUMBER" 
 from	"CUSTOMERS_VIEW" "CUSTOMERS_VIEW" 
 where 	 "CUSTOMERS_VIEW"."CUSTOMER_ID" IN (:P_CUSTID)
order by "CUSTOMERS_VIEW"."CUST_LAST_NAME"]]>
         </sql>
      </dataSet>
      <dataSet name="Orders" type="complex">
         <sql dataSourceRef="demo">
            <![CDATA[select	 "ORDER_ITEMS"."LINE_ITEM_ID" as "LINE_ITEM_ID",
	 "ORDER_ITEMS"."UNIT_PRICE" as "UNIT_PRICE",
	 "ORDER_ITEMS"."QUANTITY" as "QUANTITY",
	 "ORDERS_VIEW"."ORDER_DATE" as "ORDER_DATE",
	 "ORDERS_VIEW"."CUSTOMER_ID" as "CUSTOMER_ID",
	 "ORDERS_VIEW"."ORDER_STATUS" as "ORDER_STATUS",
	 "PRODUCT_INFORMATION"."PRODUCT_NAME" as "PRODUCT_NAME",
	 "PRODUCT_INFORMATION"."PRODUCT_DESCRIPTION" as "PRODUCT_DESCRIPTION",
	 "ORDERS_VIEW"."ORDER_ID" as "ORDER_ID",
	 "ORDERS_VIEW"."ORDER_MODE" as "ORDER_MODE",
	 "ORDERS_VIEW"."ORDER_TOTAL" as "ORDER_TOTAL" 
 from	"PRODUCT_INFORMATION" "PRODUCT_INFORMATION",
	"ORDER_ITEMS" "ORDER_ITEMS",
	"ORDERS_VIEW" "ORDERS_VIEW" 
 where   "ORDER_ITEMS"."ORDER_ID"="ORDERS_VIEW"."ORDER_ID"
 and	 "PRODUCT_INFORMATION"."PRODUCT_ID"="ORDER_ITEMS"."PRODUCT_ID"
  and 	 "ORDERS_VIEW"."ORDER_ID" IN (:P_ORDID)]]>
         </sql>
      </dataSet>
      <link name="link" parentGroup="G_1" parentColumn="CUSTOMER_ID" childQuery="Orders" childColumn="&quot;ORDERS_VIEW&quot;.&quot;CUSTOMER_ID&quot;" childColumnAlias="CUSTOMER_ID"/>
   </dataSets>
   <output rootName="DATA_DS" uniqueRowName="false">
      <nodeList name="data-structure">
         <dataStructure tagName="DATA_DS">
            <group name="G_1" label="G_1" source="Customers">
               <element name="CUSTOMER_NAME" value="CUSTOMER_NAME" label="Customer Name" dataType="xsd:string" breakOrder="None" fieldOrder="2"/>
               <element name="CUSTOMER_ID" value="CUSTOMER_ID" label="Customer ID" dataType="xsd:integer" breakOrder="None" fieldOrder="1"/>
               <element name="STREET_ADDRESS" value="STREET_ADDRESS" label="Street Address" dataType="xsd:string" breakOrder="None" fieldOrder="3"/>
               <element name="CITY" value="CITY" label="City" dataType="xsd:string" breakOrder="None" fieldOrder="5"/>
               <element name="STATE_PROVINCE" value="STATE_PROVINCE" label="State/Province" dataType="xsd:string" breakOrder="None" fieldOrder="6"/>
               <element name="POSTAL_CODE" value="POSTAL_CODE" label="Postal Code" dataType="xsd:string" breakOrder="None" fieldOrder="4"/>
               <element name="COUNTRY_NAME" value="COUNTRY_NAME" label="Country Name" dataType="xsd:string" breakOrder="None" fieldOrder="7"/>
               <element name="PRIMARY_PHONE_NUMBER" value="PRIMARY_PHONE_NUMBER" label="Phone Number" dataType="xsd:string" breakOrder="None" fieldOrder="9"/>
               <element name="CUST_EMAIL" value="CUST_EMAIL" label="Customer Email" dataType="xsd:string" breakOrder="None" fieldOrder="8"/>
               <element name="CITY_STATE_ZIP" value="${concat(concat(concat(G_1.CITY,', '),concat(G_1.STATE_PROVINCE,', ')),G_1.POSTAL_CODE)}" label="City/State/Zip" dataType="xsd:string" breakOrder="None" fieldOrder="0"/>
               <element name="CUST_TOTAL" value="G_2.LINE_TOTAL" label="Customer Total" dataType="xsd:double" breakOrder="None" fieldOrder="1" function="SUM"/>
               <group name="G_2" label="G_2" source="Orders">
                  <element name="CUSTOMER_ID" value="CUSTOMER_ID" label="Customer ID" dataType="xsd:integer" breakOrder="None" fieldOrder="5"/>
                  <element name="ORDER_ID" value="ORDER_ID" label="Order ID" dataType="xsd:integer" breakOrder="None" fieldOrder="9"/>
                  <element name="ORDER_MODE" value="ORDER_MODE" label="Channel" dataType="xsd:string" breakOrder="None" fieldOrder="10"/>
                  <element name="ORDER_DATE" value="ORDER_DATE" label="Order Date" dataType="xsd:date" breakOrder="None" fieldOrder="4"/>
                  <element name="LINE_ITEM_ID" value="LINE_ITEM_ID" label="Line Item ID" dataType="xsd:integer" breakOrder="None" fieldOrder="1"/>
                  <element name="UNIT_PRICE" value="UNIT_PRICE" label="Unit Price" dataType="xsd:double" breakOrder="None" fieldOrder="2"/>
                  <element name="QUANTITY" value="QUANTITY" label="Quantity" dataType="xsd:integer" breakOrder="None" fieldOrder="3"/>
                  <element name="PRODUCT_NAME" value="PRODUCT_NAME" label="Product Name" dataType="xsd:string" breakOrder="None" fieldOrder="7"/>
                  <element name="PRODUCT_DESCRIPTION" value="PRODUCT_DESCRIPTION" label="Product Description" dataType="xsd:string" breakOrder="None" fieldOrder="8"/>
                  <element name="ORDER_STATUS" value="ORDER_STATUS" label="Order Status" dataType="xsd:integer" breakOrder="None" fieldOrder="6"/>
                  <element name="LINE_TOTAL" value="${G_2.QUANTITY*G_2.UNIT_PRICE}" label="Line Total" dataType="xsd:double" breakOrder="None" fieldOrder="0"/>
                  <element name="ORDER_TOTAL" value="ORDER_TOTAL" label="Order Total" dataType="xsd:double" breakOrder="None" fieldOrder="11"/>
                  <element name="FRMTD_ORDER_DATE" value="${format_date(G_2.ORDER_DATE, 'DD-MMM-YY')}" label="Order Date (DD-MON-YY)" dataType="xsd:string" breakOrder="None" fieldOrder="0"/>
               </group>
            </group>
         </dataStructure>
      </nodeList>
   </output>
   <eventTriggers/>
   <lexicals/>
   <valueSets>
      <valueSet id="orders-list" cache="true">
         <sql dataSourceRef="demo">
            <![CDATA[select	 "ORDERS_VIEW"."ORDER_ID" as "ORDER_ID"
 from	"ORDERS_VIEW" "ORDERS_VIEW" 
 where 	 "ORDERS_VIEW"."CUSTOMER_ID" IN (:P_CUSTID)]]>
         </sql>
         <input id="P_CUSTID" value="${P_CUSTID}" dataType="xsd:integer"/>
      </valueSet>
      <valueSet id="customer-list" cache="true">
         <sql dataSourceRef="demo">
            <![CDATA[Select distinct cnms.cstname, cnms.cstid
From (Select  (cv.cust_last_name|| '  ' || cv.cust_first_name ) cstname, cv.customer_id cstid
from customers_view cv, orders_view ov 
where cv.customer_id = ov.customer_id) cnms
order by  cnms.cstname]]>
         </sql>
      </valueSet>
   </valueSets>
   <parameters>
      <parameter name="P_CUSTID" defaultValue="*" dataType="xsd:integer" rowPlacement="1">
         <select label="Customer Name(s): " valueSet="customer-list" multiple="true" all="true" allValue="lov" refreshParameters="true"/>
      </parameter>
      <parameter name="P_ORDID" defaultValue="*" dataType="xsd:integer" rowPlacement="1">
         <select label="Order Number(s): " valueSet="orders-list" multiple="true" all="true" allValue="lov"/>
      </parameter>
   </parameters>
   <bursting/>
   <display>
      <layouts>
         <layout name="Customers" left="300px" top="28px"/>
         <layout name="Orders" left="36px" top="151px"/>
         <layout name="DATA_DS" left="5px" top="28px"/>
      </layouts>
      <groupLinks>
         <groupLink name="link_1" parentGroup="G_1" childGroup="G_2"/>
      </groupLinks>
   </display>
</dataModel>
