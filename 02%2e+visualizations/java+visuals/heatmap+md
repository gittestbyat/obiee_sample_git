<?xml version="1.0" encoding="utf-8"?>
<saw:report xmlns:saw="com.siebel.analytics.web/report/v1.1" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:sawx="com.siebel.analytics.web/expression/v1.1" xmlVersion="201201160"><saw:criteria xsi:type="saw:simpleCriteria" subjectArea="&quot;A - Sample Sales&quot;" withinHierarchy="true"><saw:columns><saw:column xsi:type="saw:regularColumn" columnID="ca4211ddd0c1aca23"><saw:columnFormula><sawx:expr xsi:type="sawx:sqlExpression">@{Dim01}{&quot;Products&quot;.&quot;P4  Brand&quot;}</sawx:expr></saw:columnFormula><saw:displayFormat><saw:formatSpec suppress="suppress" wrapText="true" interaction="none"/></saw:displayFormat><saw:tableHeading><saw:caption fmt="text"><saw:text>Products</saw:text></saw:caption></saw:tableHeading><saw:columnHeading><saw:caption fmt="text"><saw:text>Dim1</saw:text></saw:caption><saw:displayFormat><saw:formatSpec/></saw:displayFormat></saw:columnHeading></saw:column><saw:column xsi:type="saw:regularColumn" columnID="c34c074d7d96ec712"><saw:columnFormula><sawx:expr xsi:type="sawx:sqlExpression">@{Dim02}{&quot;Offices&quot;.&quot;D4  Company&quot;}</sawx:expr></saw:columnFormula><saw:displayFormat><saw:formatSpec suppress="suppress" wrapText="true" interaction="none"/></saw:displayFormat><saw:tableHeading><saw:caption fmt="text"><saw:text>Offices</saw:text></saw:caption></saw:tableHeading><saw:columnHeading><saw:caption fmt="text"><saw:text>Dim2</saw:text></saw:caption><saw:displayFormat><saw:formatSpec/></saw:displayFormat></saw:columnHeading></saw:column><saw:column xsi:type="saw:regularColumn" columnID="c1cf5e8afe39ed9bf"><saw:columnFormula><sawx:expr xsi:type="sawx:sqlExpression">@{Met01}{&quot;Base Facts&quot;.&quot;1- Revenue&quot;}</sawx:expr></saw:columnFormula><saw:displayFormat><saw:formatSpec suppress="repeat" wrapText="true" interaction="none"><saw:dataFormat xsi:type="saw:number" minDigits="2" maxDigits="2" commas="false" negativeType="minus"/></saw:formatSpec></saw:displayFormat><saw:tableHeading><saw:caption fmt="text"><saw:text>Base Facts</saw:text></saw:caption></saw:tableHeading><saw:columnHeading><saw:displayFormat><saw:formatSpec/></saw:displayFormat><saw:caption fmt="text"><saw:text>Metric</saw:text></saw:caption></saw:columnHeading></saw:column></saw:columns></saw:criteria><saw:views currentView="3"><saw:view xsi:type="saw:compoundView" name="compoundView!1"><saw:cvTable><saw:cvRow><saw:cvCell viewName="narrativeView!1"><saw:displayFormat><saw:formatSpec/></saw:displayFormat></saw:cvCell></saw:cvRow></saw:cvTable></saw:view><saw:view xsi:type="saw:titleView" name="titleView!1"/><saw:view xsi:type="saw:tableView" name="tableView!1" scrollingEnabled="true"><saw:edges><saw:edge axis="page" showColumnHeader="true"/><saw:edge axis="section"/><saw:edge axis="row" showColumnHeader="true"><saw:edgeLayers><saw:edgeLayer type="column" columnID="ca4211ddd0c1aca23"/><saw:edgeLayer type="column" columnID="c34c074d7d96ec712"/><saw:edgeLayer type="column" columnID="c1cf5e8afe39ed9bf"/><saw:edgeLayer type="column" columnID="ce6cdb5a153e024b0"/></saw:edgeLayers></saw:edge><saw:edge axis="column" showColumnHeader="rollover"/></saw:edges></saw:view><saw:view xsi:type="saw:narrativeView" name="narrativeView!1"><saw:prefix><saw:caption fmt="html"><saw:text>&lt;script type=&quot;text/javascript&quot; src=&quot;/analyticsRes/d3/d3.v3.js&quot;&gt;&lt;/script&gt;    
&lt;script src=&#39;/analyticsRes/SampleApp/customjs/SAutilsv1.3.js&#39;&gt;&lt;/script&gt;          
 &lt;div id=&quot;heat_chart&quot;&gt;&lt;/div&gt;
&lt;script type=&quot;text/javascript&quot;&gt;
data=[];</saw:text></saw:caption></saw:prefix><saw:narrative rowCount="300"><saw:caption fmt="html"><saw:text>data.push([&quot;@{ca4211ddd0c1aca23}&quot;,&quot;@{c34c074d7d96ec712}&quot;,&quot;@{c1cf5e8afe39ed9bf}&quot;]);</saw:text></saw:caption></saw:narrative><saw:postfix><saw:caption fmt="html"><saw:text>
var margin = { top: 50, right: 0, bottom: 0, left: 100 },
          width = @{Width}{700}- margin.left - margin.right,
          height =@{Height}{700} - margin.top - margin.bottom,		  
          buckets = 1000000,
          colors = [@{Quan0}{&quot;#00FF00&quot;,&quot;#CCFFCC&quot;,&quot;#F6F7A2&quot;,&quot;#F7DDB5&quot;,&quot;#FBBCA3&quot;,&quot;#F4AEE4&quot;,&quot;#CCCCFF&quot;}],
          dim2arr = new Array(),
          heats = new Array(),
          dim1arr = new Array(),
          maxValue = 0,
          minValue = 0;  

    data.forEach(function(row, rowNo, rows) {
if(rowNo == 0 ) {
minValue = Number(row[2]);
maxValue = Number(row[2]);
}
      var dim1 = row[0];

      if (dim1arr.indexOf(dim1) &lt; 0 ){
        dim1arr.push(dim1);			
      }
      var dim2 = row[1];
	  
      if (dim2arr.indexOf(dim2) &lt; 0 ){
        dim2arr.push(dim2);					
      }

      var heat = row[2];

      heats.push(Number(heat));
      

      if (Number(heat) &lt; Number(minValue)){
        minValue = Number(heat);	
      }

      if (Number(heat) &gt; Number(maxValue)){
        maxValue = Number(heat);		
      }

    });

      var  gridWidth = (Math.floor(width / dim1arr.length))/1.3,
         gridHeight = (Math.floor(height / dim2arr.length))/2.5,
         legendElementWidth = gridWidth/1.75;


      var colorScale = d3.scale.quantile()
              .domain([minValue, maxValue])
//		.domain([0, buckets - 1, d3.max(data, function (d) { return d.value; })])
              .range(colors);

d3.range(9)

    var chartContainer = d3.select(&quot;#heat_chart&quot;).append(&quot;div&quot;).attr(&quot;id&quot;,&quot;chart&quot;);
          var svg = d3.select(&quot;#chart&quot;).append(&quot;svg&quot;)
              .attr(&quot;width&quot;, width + margin.left + margin.right)
              .attr(&quot;height&quot;, height + margin.top + margin.bottom)
              .append(&quot;g&quot;)
              .attr(&quot;transform&quot;, &quot;translate(&quot; + margin.left + &quot;,&quot; + margin.top + &quot;)&quot;);     

            
     var dim2Labels = svg.selectAll(&quot;.dim2Label&quot;)
              .data(dim2arr)
              .enter().append(&quot;text&quot;)
                .text(function (d) { return d; })
                .attr(&quot;x&quot;, 0)
                .attr(&quot;y&quot;, function (d, i) { return i * gridHeight; })
                .style(&quot;text-anchor&quot;, &quot;end&quot;)
                .attr(&quot;transform&quot;, &quot;translate(-6,&quot; + gridHeight / 2 + &quot;)&quot;)
                .attr(&quot;font-size&quot;, &quot;10px&quot;);  ;
    
 
     var dim1Labels = svg.selectAll(&quot;.dim1Label&quot;)
              .data(dim1arr)
              .enter().append(&quot;text&quot;)
                .text(function(d) { console.log(&quot;vik:&quot; + d);
                                     return d;})
                .attr(&quot;x&quot;, function (d, i) { return i * gridWidth; })
                .attr(&quot;y&quot;, function (d, i) { return 0;/*if(i%2 == 0) return 0; else return -20*/ })
                .style(&quot;text-anchor&quot;, &quot;middle&quot;)
                .attr(&quot;transform&quot;, &quot;translate(&quot; + gridWidth / 2 + &quot;, -6)&quot;)
  //              .attr(&quot;class&quot;, function(d, i) { return &quot;dim1Label mono axis axis-dim1&quot;; })
                .attr(&quot;font-size&quot;, &quot;10px&quot;);




     var heatMap = svg.selectAll(&quot;.hour&quot;)
              .data(data)
              .enter().append(&quot;g&quot;);
 
       var heatMapRect = heatMap.append(&quot;rect&quot;)
              .attr(&quot;x&quot;, function(d) { return ( dim1arr.indexOf(d[0])) * gridWidth; })
              .attr(&quot;y&quot;, function(d) { return (dim2arr.indexOf(d[1])) * gridHeight; })
              .attr(&quot;rx&quot;, 4)
              .attr(&quot;ry&quot;, 4)
              .attr(&quot;class&quot;, &quot;bordered&quot;)
              .attr(&quot;width&quot;, gridWidth/1.01)
              .attr(&quot;height&quot;, gridHeight/1.01)
              .style(&quot;fill&quot;, &quot;#ffffff&quot;);


       heatMap.append(&quot;text&quot;)
       .text(function(d){ return d[2].toString();
//return Math.round(d[2]).toString(); 
})
//       .text(function(d){ return d[2].toString()})
        .attr(&quot;x&quot;, function(d) {  return ( dim1arr.indexOf(d[0])) * gridWidth; })
        .attr(&quot;y&quot;, function(d) { return (dim2arr.indexOf(d[1])) * gridHeight + 15; } )
        .attr(&quot;dx&quot;, 15)
        .attr(&quot;font-size&quot;, function(d){ return &quot;10px&quot;})
        .attr(&quot;font-weight&quot;, function(d){ return &quot;normal&quot;; });

heatMap.on(&quot;click&quot;,function(d){sendEvent(d)}) ;

function sendEvent(d) {
 var v=[&#39;@{Dim01}{&quot;Products&quot;.&quot;P3  LOB&quot;}&#39;, d[0], &#39;@{Dim02}{&quot;Time&quot;.&quot;T03 Per Name Qtr&quot;}&#39;, d[1]];
SAutils.publishMDEvent(&#39;MD&#39;,v);
}
        //create legends
      heatMapRect.transition().duration(30)
              .style(&quot;fill&quot;, function(d) {  return colorScale(d[2]); });


      heatMap.append(&quot;title&quot;).text(function(d) { return d.value; });

		   

       var legend = svg.selectAll(&quot;.legend&quot;)
              .data([0].concat(colorScale.quantiles()), function(d) { return d; })
              //.data(colorScale.quantiles())
              .enter().append(&quot;g&quot;)
              .attr(&quot;class&quot;, &quot;legend&quot;);

			  
        legend.append(&quot;rect&quot;)
            .attr(&quot;x&quot;, function(d, i) { return legendElementWidth * i; })
            .attr(&quot;y&quot;, gridHeight*(dim2arr.length) + 30)
            .attr(&quot;width&quot;, legendElementWidth)
            .attr(&quot;height&quot;, (gridWidth / 5))
            .style(&quot;fill&quot;, function(d, i) { return colors[i]; });

         legend.append(&quot;text&quot;)
      .text(function(d) { return &quot;&gt; &quot; + Math.round(d); })			
            .attr(&quot;x&quot;, function(d, i) { return legendElementWidth * i; })
            .attr(&quot;y&quot;, gridHeight*(dim2arr.length) + (gridWidth / 3) + 50)
            .attr(&quot;font-size&quot;, &quot;10px&quot;);


    
&lt;/script&gt;</saw:text></saw:caption></saw:postfix></saw:view><saw:view xsi:type="saw:pivotTableView" name="pivotTableView!1" scrollingEnabled="true"><saw:edges><saw:edge axis="page" showColumnHeader="true"/><saw:edge axis="section"/><saw:edge axis="row" showColumnHeader="true"><saw:edgeLayers><saw:edgeLayer type="column" columnID="c34c074d7d96ec712"/></saw:edgeLayers></saw:edge><saw:edge axis="column" showColumnHeader="rollover"><saw:edgeLayers><saw:edgeLayer type="column" columnID="ca4211ddd0c1aca23"/><saw:edgeLayer type="measure"/></saw:edgeLayers></saw:edge></saw:edges><saw:measuresList><saw:measure columnID="c1cf5e8afe39ed9bf"/><saw:measure columnID="ce6cdb5a153e024b0"/></saw:measuresList></saw:view><saw:view xsi:type="saw:tableView" name="tableView!2" scrollingEnabled="true"><saw:edges><saw:edge axis="page" showColumnHeader="true"/><saw:edge axis="section"/><saw:edge axis="row" showColumnHeader="true"><saw:edgeLayers><saw:edgeLayer type="column" columnID="ca4211ddd0c1aca23"/><saw:edgeLayer type="column" columnID="c34c074d7d96ec712"/><saw:edgeLayer type="column" columnID="c1cf5e8afe39ed9bf"/><saw:edgeLayer type="column" columnID="ce6cdb5a153e024b0"/></saw:edgeLayers></saw:edge><saw:edge axis="column" showColumnHeader="rollover"/></saw:edges></saw:view><saw:view xsi:type="saw:pivotTableView" name="pivotTableView!2" scrollingEnabled="true"><saw:edges><saw:edge axis="page" showColumnHeader="true"/><saw:edge axis="section"><saw:edgeLayers/></saw:edge><saw:edge axis="row" showColumnHeader="true"><saw:edgeLayers><saw:edgeLayer type="column" columnID="c34c074d7d96ec712"/></saw:edgeLayers></saw:edge><saw:edge axis="column" showColumnHeader="rollover"><saw:edgeLayers><saw:edgeLayer type="column" columnID="ca4211ddd0c1aca23"/><saw:edgeLayer type="measure"/></saw:edgeLayers></saw:edge></saw:edges><saw:measuresList><saw:measure columnID="c1cf5e8afe39ed9bf"/></saw:measuresList></saw:view><saw:view xsi:type="saw:tableView" name="tableView!3" scrollingEnabled="true"><saw:edges><saw:edge axis="page" showColumnHeader="true"/><saw:edge axis="section"/><saw:edge axis="row" showColumnHeader="true"><saw:edgeLayers><saw:edgeLayer type="column" columnID="ca4211ddd0c1aca23"/><saw:edgeLayer type="column" columnID="c34c074d7d96ec712"/><saw:edgeLayer type="column" columnID="c1cf5e8afe39ed9bf"/></saw:edgeLayers><saw:columnOrder><saw:columnOrderRef columnID="c1cf5e8afe39ed9bf" direction="ascending"/></saw:columnOrder></saw:edge><saw:edge axis="column" showColumnHeader="rollover"/></saw:edges></saw:view><saw:view xsi:type="saw:pivotTableView" name="pivotTableView!3" scrollingEnabled="true" clientEventChannels="MD" clientEventEnabled="true"><saw:edges><saw:edge axis="page" showColumnHeader="true"><saw:edgeLayers><saw:edgeLayer type="column" columnID="c34c074d7d96ec712"/><saw:edgeLayer type="column" columnID="ca4211ddd0c1aca23"/></saw:edgeLayers></saw:edge><saw:edge axis="section"/><saw:edge axis="row" showColumnHeader="true"/><saw:edge axis="column" showColumnHeader="rollover"><saw:edgeLayers><saw:edgeLayer type="measure"/></saw:edgeLayers></saw:edge></saw:edges><saw:measuresList><saw:measure columnID="c1cf5e8afe39ed9bf"/></saw:measuresList><saw:pageEdgeState><saw:QDR><saw:staticMemberGroup><saw:groupType><sawx:columnRefExpr columnID="c34c074d7d96ec712"/></saw:groupType><saw:members xsi:type="saw:stringMembers"><saw:value>Tescare Ltd.</saw:value></saw:members></saw:staticMemberGroup><saw:staticMemberGroup><saw:groupType><sawx:columnRefExpr columnID="ca4211ddd0c1aca23"/></saw:groupType><saw:members xsi:type="saw:stringMembers"><saw:value>BizTech</saw:value></saw:members></saw:staticMemberGroup></saw:QDR><saw:selectionGroups><saw:selectionGroup columnID="c34c074d7d96ec712" groupID="0"/><saw:selectionGroup columnID="ca4211ddd0c1aca23" groupID="0"/></saw:selectionGroups></saw:pageEdgeState></saw:view><saw:view xsi:type="saw:tableView" name="tableView!4" scrollingEnabled="true"><saw:edges><saw:edge axis="page" showColumnHeader="true"/><saw:edge axis="section"/><saw:edge axis="row" showColumnHeader="true"><saw:edgeLayers><saw:edgeLayer type="column" columnID="c34c074d7d96ec712"/><saw:edgeLayer type="column" columnID="ca4211ddd0c1aca23"/><saw:edgeLayer type="column" columnID="c1cf5e8afe39ed9bf"/></saw:edgeLayers></saw:edge><saw:edge axis="column" showColumnHeader="rollover"/></saw:edges></saw:view></saw:views><saw:prompts scope="report" subjectArea="&quot;A - Sample Sales&quot;"/></saw:report>