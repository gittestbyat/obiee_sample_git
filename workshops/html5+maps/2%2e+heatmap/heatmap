<?xml version="1.0" encoding="utf-8"?>
<saw:report xmlns:saw="com.siebel.analytics.web/report/v1.1" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlVersion="201201160" xmlns:sawx="com.siebel.analytics.web/expression/v1.1">
   <saw:criteria xsi:type="saw:simpleCriteria" subjectArea="&quot;A - Sample Sales&quot;" withinHierarchy="true">
      <saw:columns>
         <saw:column xsi:type="saw:regularColumn" columnID="c76807cd32af66b6d">
            <saw:columnFormula>
               <sawx:expr xsi:type="sawx:sqlExpression">&quot;Ship To Geo Codes&quot;.&quot;R64  Latitude&quot;</sawx:expr></saw:columnFormula>
            <saw:displayFormat>
               <saw:formatSpec suppress="repeat" wrapText="true">
                  <saw:dataFormat xsi:type="saw:number" minDigits="6" maxDigits="6" commas="false" negativeType="minus"/></saw:formatSpec></saw:displayFormat>
            <saw:columnHeading>
               <saw:displayFormat>
                  <saw:formatSpec/></saw:displayFormat></saw:columnHeading></saw:column>
         <saw:column xsi:type="saw:regularColumn" columnID="cf0e28a32c711944a">
            <saw:columnFormula>
               <sawx:expr xsi:type="sawx:sqlExpression">&quot;Ship To Geo Codes&quot;.&quot;R65  Longitude&quot;</sawx:expr></saw:columnFormula>
            <saw:displayFormat>
               <saw:formatSpec suppress="repeat" wrapText="true">
                  <saw:dataFormat xsi:type="saw:number" minDigits="6" maxDigits="6" commas="false" negativeType="minus"/></saw:formatSpec></saw:displayFormat>
            <saw:columnHeading>
               <saw:displayFormat>
                  <saw:formatSpec/></saw:displayFormat></saw:columnHeading></saw:column>
         <saw:column xsi:type="saw:regularColumn" columnID="c5a88b13abb8b2a7b">
            <saw:columnFormula>
               <sawx:expr xsi:type="sawx:sqlExpression">&quot;Ship To Geo Codes&quot;.&quot;R68  Geo Establisht&quot;</sawx:expr></saw:columnFormula></saw:column>
         <saw:column xsi:type="saw:regularColumn" columnID="c5202b88b2c4ee900">
            <saw:columnFormula>
               <sawx:expr xsi:type="sawx:sqlExpression">@{metric==&#39;Billed Quantity&#39;? &#39;&quot;Base Facts&quot;.&quot;2- Billed Quantity&quot;&#39;:&#39;&quot;Base Facts&quot;.&quot;1- Revenue&quot;&#39;}</sawx:expr></saw:columnFormula>
            <saw:displayFormat>
               <saw:formatSpec suppress="repeat" wrapText="true">
                  <saw:dataFormat xsi:type="saw:number" minDigits="0" maxDigits="0" commas="false" negativeType="minus"/></saw:formatSpec></saw:displayFormat>
            <saw:tableHeading>
               <saw:caption fmt="text">
                  <saw:text>Base Facts</saw:text></saw:caption></saw:tableHeading>
            <saw:columnHeading>
               <saw:displayFormat>
                  <saw:formatSpec/></saw:displayFormat>
               <saw:caption fmt="text">
                  <saw:text>1- Revenue</saw:text></saw:caption></saw:columnHeading></saw:column>
         
         </saw:columns>
      <saw:filter>
         <sawx:expr xsi:type="sawx:logical" op="and">
            <sawx:expr xsi:type="sawx:comparison" op="equal">
               <sawx:expr xsi:type="sawx:sqlExpression">&quot;Ship To Regions&quot;.&quot;R55  City&quot;</sawx:expr>
               <sawx:expr xsi:type="xsd:string">San Francisco</sawx:expr></sawx:expr>
            <sawx:expr xsi:type="sawx:comparison" op="equal">
               <sawx:expr xsi:type="sawx:sqlExpression">&quot;Time&quot;.&quot;T05 Per Name Year&quot;</sawx:expr>
               <sawx:expr xsi:type="xsd:string">2013</sawx:expr></sawx:expr><sawx:expr xsi:type="sawx:special" op="prompted"><sawx:expr xsi:type="sawx:sqlExpression">&quot;Ship To Geo Codes&quot;.&quot;R68  Geo Establisht&quot;</sawx:expr></sawx:expr></sawx:expr></saw:filter></saw:criteria>
   <saw:views currentView="0">
      <saw:view xsi:type="saw:compoundView" name="compoundView!1">
         <saw:cvTable><saw:cvRow><saw:cvCell viewName="htmlview!1"/></saw:cvRow><saw:cvRow><saw:cvCell viewName="narrativeView!1"/></saw:cvRow></saw:cvTable></saw:view>
      <saw:view xsi:type="saw:tableView" name="tableView!1" rowsPerPage="900">
         <saw:edges>
            <saw:edge axis="page" showColumnHeader="true">
               <saw:edgeLayers/></saw:edge>
            <saw:edge axis="section"/>
            <saw:edge axis="row" showColumnHeader="true">
               <saw:edgeLayers>
                  <saw:edgeLayer type="column" columnID="c76807cd32af66b6d"/>
                  <saw:edgeLayer type="column" columnID="cf0e28a32c711944a"/>
                  <saw:edgeLayer type="column" columnID="c879fe00e387f019e"/>
                  <saw:edgeLayer type="column" columnID="c5a88b13abb8b2a7b"/>
                  <saw:edgeLayer type="column" columnID="c9745436d332c72a3"/>
                  <saw:edgeLayer type="column" columnID="c5202b88b2c4ee900"/></saw:edgeLayers>
               <saw:columnOrder>
                  <saw:columnOrderRef columnID="c5202b88b2c4ee900" direction="descending"/></saw:columnOrder></saw:edge>
            <saw:edge axis="column" showColumnHeader="rollover"/></saw:edges></saw:view>
      <saw:view xsi:type="saw:narrativeView" name="narrativeView!1">
         <saw:prefix>
            <saw:caption fmt="html">
               <saw:text>&lt;script&gt;
var darray= [];</saw:text></saw:caption></saw:prefix>
         <saw:narrative rowCount="1000">
            <saw:caption fmt="html">
               <saw:text>darray.push([@{c76807cd32af66b6d},@{cf0e28a32c711944a},&quot;@{c5a88b13abb8b2a7b}&quot;,@{c5202b88b2c4ee900}]);</saw:text></saw:caption></saw:narrative>
         
         <saw:postfix>
            <saw:caption fmt="html">
               <saw:text>renderHeatMap(darray);
&lt;/script&gt;</saw:text></saw:caption></saw:postfix></saw:view>
      <saw:view xsi:type="saw:htmlview" name="htmlview!1">
         <saw:staticText>
            <saw:caption fmt="html">
               <saw:text>&lt;b&gt;Density based heatmap&lt;/b&gt;
&lt;DIV id=map style=&quot;width:700px;height:750px;padding:10px;border:1px solid grey;&quot;&gt;&lt;/DIV&gt;

&lt;script src=&#39;/mapviewer/jslib/v2/oraclemapsv2.js&#39;&gt;&lt;/script&gt;

&lt;script&gt;
function addPoints(darray,layer){
  /*lat,long,estb,metric*/
  for (i=0;i&lt;darray.length; i++){
  		var fid = i;
  		var mpoint = new OM.geometry.Point(darray[i][1], darray[i][0],8307);
  		var f_attr = {attributes :{&quot;_LABEL_&quot;:darray[i][2], &quot;Sales&quot;:darray[i][3]+&quot;&quot;}};
  		var feature = new OM.Feature(fid,mpoint,f_attr);  
  		layer.addFeature(feature);
  	}
}

function renderHeatMap(darray){
  var baseURL= &quot;http://&quot;+document.location.host+&quot;/mapviewer&quot;;
  var map = new OM.Map(document.getElementById(&#39;map&#39;), {mapviewerURL: baseURL}) ;
  map.addLayer(new OM.layer.ElocationTileLayer(&quot;background&quot;)) ;  
  
  var colors = [&quot;#C6DBEF&quot;,&quot;#6BAED6&quot;,&quot;#008fff&quot;,&quot;#00abff&quot;,&quot;#00d5ff&quot;,&quot;#00ffff&quot;,&quot;#00ff7f&quot;,&quot;#00ff00&quot;,&quot;#7fff00&quot;,&quot;#ffff00&quot;,&quot;#ffd500&quot;,&quot;#ffab00&quot;,&quot;#ff7f00&quot;,&quot;#ff5600&quot;,&quot;#ff2b00&quot;, &quot;#ff0000&quot;, &quot;#A50F15&quot;];
  var config = {
    spotlightRadius:25,
    lengthUnit:&#39;pixel&#39;,
    colorStops: colors,
    opacity:0.65,                   
    sampleFactor: 4 
  };
  var style = new OM.style.HeatMap(config);

  var heatLayer = new OM.layer.VectorLayer(&quot;heatlayer&quot;,{
      def:
          {
          type: OM.layer.VectorLayer.TYPE_LOCAL
      },
      renderingStyle :style
	  //styleAttributes:[&quot;METRIC&quot;]
  });
  addPoints(darray,heatLayer);
  map.addLayer(heatLayer);
  
  var marker = new OM.style.Marker({src: &quot;/mapviewer/icons/BALL_sel.png&quot;, width:7, height:7});                
  var pLayer = new OM.layer.VectorLayer(&quot;pointlayer&quot;,{
      def:
      {
          type: OM.layer.VectorLayer.TYPE_LOCAL
      },
      renderingStyle : marker
  });
  addPoints(darray,pLayer);
  map.addLayer(pLayer);
  //pLayer.setVisible(true);
  if (&#39;@{pLayer_flag}&#39;==&#39;No&#39;)  pLayer.setVisible(false);
  map.addMapDecoration(new OM.control.NavigationPanelBar({ style:1 }));
  var mpoint = new OM.geometry.Point(-122.43,37.716,8307);
  map.setMapCenter(mpoint);
  map.setMapZoomLevel(11) ; 
    var copyright = new OM.control.CopyRight({
            anchorPosition:4,
            textValue:&quot;©2014 Oracle. Map data ©2013 HERE&quot;,
            fontSize:9,
            fontFamily:&quot;Tahoma&quot;,
            fontColor:&quot;black&quot;
    });          
    map.addMapDecoration(copyright);          

  map.init();
}
&lt;/script&gt;


</saw:text></saw:caption></saw:staticText></saw:view>
      
      </saw:views></saw:report>